{% extends "base.html" %}

{% block content %}
<h1>Son Analizler</h1>

<form method="GET" class="filter-form">
    <label>Sentiment filtre (örn. POSITIVE, NEGATIVE, NEUTRAL):</label>
    <input type="text" name="sentiment" value="{{ sentiment_filter or '' }}">
    <button type="submit" class="btn-primary">Filtrele</button>
    {% if sentiment_filter %}
        <a href="{{ url_for('history') }}">Filtreyi temizle</a>
    {% endif %}
</form>

<table class="history-table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Tarih (UTC)</th>
            <th>Kaynak tipi</th>
            <th>Girdi</th>
            <th>Özet (ilk 120 karakter)</th>
            <th>Sentiment</th>
            <th>Bias Skoru</th>
            <th>Detay</th>
        </tr>
    </thead>
    <tbody>
    {% for row in rows %}
        <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3][:60] }}{% if row[3]|length > 60 %}...{% endif %}</td>
            <td>{{ row[4][:120] }}{% if row[4]|length > 120 %}...{% endif %}</td>
            <td>{{ row[5] }} ({{ "%.2f"|format(row[6]) }})</td>
            <td>{{ row[7] }}</td>
            <td><a href="{{ url_for('analysis_detail', analysis_id=row[0]) }}">Gör</a></td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
